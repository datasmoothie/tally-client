
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Build Excel tables</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/assets/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The API" href="the_api.html" />
    <link rel="prev" title="Create crosstabs" href="6_create_crosstabs.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/datasmoothie-logo.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Quick_Start.html">
   Quick start
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The pipeline
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="pipeline_intro.html">
   Building a survey data pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1_load_data.html">
   Load/extract data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_explore_data.html">
   Explore data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_clean_data.html">
   Clean data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_create_variables.html">
   Create variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_weight_data.html">
   Weight data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_create_crosstabs.html">
   Create crosstabs
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Build Excel tables
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="the_api.html">
   The API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="api_build.html">
   Building outputs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="api_dataset.html">
   DataSet class
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="terminology.html">
   Terminology
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right"><a href="https://github.com/datasmoothie/tally-client"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-build-object">
   The build object
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-sheets-tables-and-saving-the-excel-file">
   Adding sheets, tables and saving the Excel file
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-multiple-sheets">
     Adding multiple sheets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-the-excel-document">
     Creating the Excel document
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-build-options-on-a-build-sheet-and-table-level">
   Setting build options on a build, sheet, and table level
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-options-on-a-build-level">
     Setting options on a build level
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-options-on-a-sheet-level">
     Setting options on a sheet level
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-options-on-a-table-level">
     Setting options on a table level
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deciding-what-data-to-include">
   Deciding what data to include
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#significance-testing">
     Significance testing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#descriptive-statistics">
     Descriptive statistics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#annotations">
     Annotations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#controlling-visuals">
   Controlling visuals
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-format-dictionary">
     The format dictionary
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-a-header-title-to-a-table">
     Adding a header/title to a table
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#formatting-options">
   Formatting options
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Build Excel tables</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-build-object">
   The build object
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-sheets-tables-and-saving-the-excel-file">
   Adding sheets, tables and saving the Excel file
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-multiple-sheets">
     Adding multiple sheets
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-the-excel-document">
     Creating the Excel document
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-build-options-on-a-build-sheet-and-table-level">
   Setting build options on a build, sheet, and table level
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-options-on-a-build-level">
     Setting options on a build level
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-options-on-a-sheet-level">
     Setting options on a sheet level
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setting-options-on-a-table-level">
     Setting options on a table level
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deciding-what-data-to-include">
   Deciding what data to include
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#significance-testing">
     Significance testing
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#descriptive-statistics">
     Descriptive statistics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#annotations">
     Annotations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#controlling-visuals">
   Controlling visuals
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-format-dictionary">
     The format dictionary
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-a-header-title-to-a-table">
     Adding a header/title to a table
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#formatting-options">
   Formatting options
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="build-excel-tables">
<h1>Build Excel tables<a class="headerlink" href="#build-excel-tables" title="Permalink to this headline">#</a></h1>
<p>The Tally Python SDK has a flexible feature set to build large Excel data tables and gives the user full, granular control over the content of the tables.</p>
<p><img alt="Tally supports building large Excel data files and granular control" src="_images/excel-tables-with-toc.png" /></p>
<section id="the-build-object">
<h2>The build object<a class="headerlink" href="#the-build-object" title="Permalink to this headline">#</a></h2>
<p>Tally implements an object called <code class="docutils literal notranslate"><span class="pre">build</span></code> which represents each build of outputs. Each build has a list of sheets and each sheet has a list of tables.</p>
<p><img alt="Tally supports building large Excel data files and granular control" src="_images/excel-build-diagram.png" /></p>
<p>If there are more than one sheets in a build, a table of contents is automatically created. A logo can also be included in the build and font familyi and font sizes can be set.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span> <span class="o">=</span> <span class="n">tally</span><span class="o">.</span><span class="n">Build</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Sport survey&quot;</span><span class="p">,</span> 
    <span class="n">subtitle</span><span class="o">=</span><span class="s2">&quot;Annual research conducted by agency X&quot;</span><span class="p">,</span>
    <span class="n">default_dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
    <span class="n">table_of_contents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">logo</span><span class="o">=</span><span class="s1">&#39;./images/datasmoothie-logo.png&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="adding-sheets-tables-and-saving-the-excel-file">
<h2>Adding sheets, tables and saving the Excel file<a class="headerlink" href="#adding-sheets-tables-and-saving-the-excel-file" title="Permalink to this headline">#</a></h2>
<p>Once we have created the <code class="docutils literal notranslate"><span class="pre">build</span></code>, we can add sheets and tables. Every sheet must belong to a build and every table must belong to a sheet.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sheet</span> <span class="o">=</span> <span class="n">build</span><span class="o">.</span><span class="n">add_sheet</span><span class="p">(</span><span class="n">banner</span><span class="o">=</span><span class="s1">&#39;Wave&#39;</span><span class="p">)</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Waves&#39;</span>

<span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span><span class="s2">&quot;q1&quot;</span><span class="p">})</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span><span class="s2">&quot;q2&quot;</span><span class="p">})</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span><span class="s2">&quot;q3&quot;</span><span class="p">})</span>
</pre></div>
</div>
<section id="adding-multiple-sheets">
<h3>Adding multiple sheets<a class="headerlink" href="#adding-multiple-sheets" title="Permalink to this headline">#</a></h3>
<p>We can use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop to add multiple sheets to our build.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">stub</span> <span class="ow">in</span> <span class="n">stub_vars</span><span class="p">:</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">build</span><span class="o">.</span><span class="n">add_sheet</span><span class="p">(</span><span class="n">banner</span><span class="o">=</span><span class="n">banner_vars</span><span class="p">)</span>
    <span class="n">sheet</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_variable_text</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">stub</span><span class="p">)</span>
    <span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span><span class="n">stub</span><span class="p">})</span>

</pre></div>
</div>
</section>
<section id="creating-the-excel-document">
<h3>Creating the Excel document<a class="headerlink" href="#creating-the-excel-document" title="Permalink to this headline">#</a></h3>
<p>Once we’ve added our sheets and tables to the build, we can create the Excel document.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="o">.</span><span class="n">save_excel</span><span class="p">(</span><span class="s1">&#39;client_results.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A new file will get saved in the location your python script is located, called client_results.xlsx.</p>
</section>
</section>
<section id="setting-build-options-on-a-build-sheet-and-table-level">
<h2>Setting build options on a build, sheet, and table level<a class="headerlink" href="#setting-build-options-on-a-build-sheet-and-table-level" title="Permalink to this headline">#</a></h2>
<p>Most data-specific and visual options can be set on a build, sheet or table level. For example, the entire build could use a certain variable for weighting, certain sheets can be tested for significance and certain tables could show descriptive statistics.</p>
<section id="setting-options-on-a-build-level">
<h3>Setting options on a build level<a class="headerlink" href="#setting-options-on-a-build-level" title="Permalink to this headline">#</a></h3>
<p>Options set on the build level will apply to every table in every sheet, unless otherwise specified. Sheet options override build options and table options override both.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="s1">&#39;weight_a&#39;</span><span class="p">)</span>
<span class="n">build</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_ci</span><span class="p">([</span><span class="s1">&#39;c%&#39;</span><span class="p">,</span> <span class="s1">&#39;counts&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The above will weight all results with the variable <code class="docutils literal notranslate"><span class="pre">weight_a</span></code> and only show both percentages and counts in all tables.</p>
</section>
<section id="setting-options-on-a-sheet-level">
<h3>Setting options on a sheet level<a class="headerlink" href="#setting-options-on-a-sheet-level" title="Permalink to this headline">#</a></h3>
<p>Options can be set on a per-sheet level. If we’ve already set certain options on a build level, these will be overridden by sheet-level options.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_stats</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span>
<span class="n">sheet1</span> <span class="o">=</span> <span class="n">build</span><span class="o">.</span><span class="n">add_sheet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Q1 With means&quot;</span><span class="p">,</span> <span class="n">banner</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;locality&quot;</span><span class="p">])</span>
<span class="n">sheet1</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;q1&#39;</span><span class="p">})</span>
<span class="n">sheet2</span> <span class="o">=</span> <span class="n">build</span><span class="o">.</span><span class="n">add_sheet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Q1 With means and standard deviation&quot;</span><span class="p">,</span> <span class="n">banner</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;locality&quot;</span><span class="p">])</span>
<span class="n">sheet2</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_stats</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;stddev&#39;</span><span class="p">])</span>
<span class="n">sheet2</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;q2&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>In the above, <code class="docutils literal notranslate"><span class="pre">sheet1</span></code> and will have mean calculations included in its tables, whereas <code class="docutils literal notranslate"><span class="pre">sheet2</span></code> will have both means and standard deviation. Every other sheet added will have mean calculated, but not standard deviation.</p>
</section>
<section id="setting-options-on-a-table-level">
<h3>Setting options on a table level<a class="headerlink" href="#setting-options-on-a-table-level" title="Permalink to this headline">#</a></h3>
<p>Options can also be set on a table-level, if there’s only one table in a sheet that should have certain data included.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_weight</span><span class="p">(</span><span class="s1">&#39;weight_a&#39;</span><span class="p">)</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">build</span><span class="o">.</span><span class="n">add_sheet</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Q1&quot;</span><span class="p">,</span> <span class="n">banner</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;locality&quot;</span><span class="p">])</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;q1&#39;</span><span class="p">})</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;q2&#39;</span><span class="p">},</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span><span class="s1">&#39;weight_b&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>In the above, every table in the sheet will be weighted with the weight variable <code class="docutils literal notranslate"><span class="pre">weight_a</span></code> except that last one, which will be weighted with <code class="docutils literal notranslate"><span class="pre">weight_b</span></code>.</p>
</section>
</section>
<section id="deciding-what-data-to-include">
<h2>Deciding what data to include<a class="headerlink" href="#deciding-what-data-to-include" title="Permalink to this headline">#</a></h2>
<p>Tally Excel builds support all the data you would expect to be able to include, such as</p>
<ul class="simple">
<li><p>Counts</p></li>
<li><p>Percentages</p></li>
<li><p>Bases (weighted and unweighted)</p></li>
<li><p>Significance testing</p></li>
<li><p>Descriptive statistics (mean, standard deviation, etc.)</p></li>
</ul>
<p>All of the above are options we send to the <code class="docutils literal notranslate"><span class="pre">crosstab</span></code> method and the options available are shown in the <a class="reference external" href="https://tally.datasmoothie.com/#tag/Aggregations/operation/crosstab">API Reference for the crosstab method</a>.</p>
<section id="significance-testing">
<h3>Significance testing<a class="headerlink" href="#significance-testing" title="Permalink to this headline">#</a></h3>
<p>Significance testing is done by adding an alpha paremeter (or significance level parameter). This is often 0.05 or 0.10. This can be done on a build, sheet or table level.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># build level</span>
<span class="n">build</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_sig_test_levels</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># sheet level</span>
<span class="n">build</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_sig_test_levels</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># table level</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;q1&#39;</span><span class="p">,</span> <span class="s1">&#39;sig_level&#39;</span><span class="p">:[</span><span class="mf">0.05</span><span class="p">]})</span>
</pre></div>
</div>
</section>
<section id="descriptive-statistics">
<h3>Descriptive statistics<a class="headerlink" href="#descriptive-statistics" title="Permalink to this headline">#</a></h3>
<p>Descriptive statistics are added to tables with the <code class="docutils literal notranslate"><span class="pre">set_stats</span></code> options for builds and sheets, and the <code class="docutils literal notranslate"><span class="pre">stats</span></code> option for tables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_stats</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span>
<span class="n">sheet10</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_stats</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;stddev&#39;</span><span class="p">])</span>
<span class="n">sheet10</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="s1">&#39;q1&#39;</span><span class="p">,</span> <span class="s1">&#39;stats&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;stddev&#39;</span><span class="p">]})</span>
</pre></div>
</div>
<p>Available statistics are</p>
<ul class="simple">
<li><p>mean: Mean,</p></li>
<li><p>min: Min,</p></li>
<li><p>max: Max,</p></li>
<li><p>median: Median,</p></li>
<li><p>var: Sample variance,</p></li>
<li><p>varcoeff: Coefficient of variation,</p></li>
<li><p>stddev: Std. dev,</p></li>
<li><p>sem: Std. err. of mean,</p></li>
<li><p>sum: Total Sum,</p></li>
<li><p>lower_q: Lower quartile,</p></li>
<li><p>upper_q: Upper quartile’</p></li>
</ul>
</section>
<section id="annotations">
<h3>Annotations<a class="headerlink" href="#annotations" title="Permalink to this headline">#</a></h3>
<p>Tables can include annotations that show</p>
<ul class="simple">
<li><p>what variable was used as a weight</p></li>
<li><p>how the base was selected (e.g. Location: London)</p></li>
<li><p>the alpha parameter in the significance testing</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_annotations</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_annotations</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="controlling-visuals">
<h2>Controlling visuals<a class="headerlink" href="#controlling-visuals" title="Permalink to this headline">#</a></h2>
<p>Users can set formatting for result types in a table (percentages, counts, stats) and these can be set on the entire table or on a column-by-column basis. The following are the most common commands.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">set_format</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_answer_format</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_column_format_for_type</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_base_labels</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_banner_border</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_base_position</span></code></p></li>
</ul>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># make all descriptive statistics appear in a certain colour</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_format</span><span class="p">(</span><span class="s1">&#39;stats&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;font_color&quot;</span><span class="p">:</span><span class="s2">&quot;98B4DF&quot;</span><span class="p">})</span>
<span class="c1"># set the format for all base rows, making them bold, with a border and in a color</span>
<span class="n">build</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_format</span><span class="p">(</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;border_color&#39;</span><span class="p">:</span><span class="s1">&#39;efefef&#39;</span><span class="p">})</span>
<span class="c1"># Make the base in column 1 always be bold</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_column_format_for_type</span><span class="p">(</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;bold&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>For more information about each function, see <a class="reference internal" href="api_build.html"><span class="doc std std-doc">the section about the Build API</span></a>.</p>
<section id="the-format-dictionary">
<h3>The format dictionary<a class="headerlink" href="#the-format-dictionary" title="Permalink to this headline">#</a></h3>
<p>Formats are controlled by contstructing a format dictionary. This is a dictionary with keys that indicate what format should be changed and values that indicate how the formats should be set. For example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span><span class="n">efefef</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">:</span><span class="s1">&#39;left}</span>
</pre></div>
</div>
<p>For a list of formatting options used to build the formatting dictionary, see the <a href="#formatting-options">formatting options list</a></p>
</section>
<section id="adding-a-header-title-to-a-table">
<h3>Adding a header/title to a table<a class="headerlink" href="#adding-a-header-title-to-a-table" title="Permalink to this headline">#</a></h3>
<p>Options can be set on a table level as well, and this can be used to add a header to the table.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span>
    <span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="o">...</span><span class="p">},</span> 
    <span class="n">options</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;title&#39;</span><span class="p">:{</span><span class="s1">&#39;text&#39;</span><span class="p">:</span><span class="s1">&#39;This is my title&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span><span class="s1">&#39;#ebebeb&#39;</span><span class="p">}}</span>
    <span class="p">}</span>
<span class="p">)</span>

</pre></div>
</div>
<p>For the formatting options available for the header, see the <a href="#formatting-options">formatting options list</a>.</p>
</section>
</section>
<section id="formatting-options">
<h2>Formatting options<a class="headerlink" href="#formatting-options" title="Permalink to this headline">#</a></h2>
<p>The look and format of every question, label and data table can be set to get the right look and feel.</p>
<table border="0" class="table">
<colgroup>
<col width="15%">
<col width="22%">
<col width="27%">
<col width="37%">
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Category</th>
<th class="head">Description</th>
<th class="head">Property</th>
<th class="head">Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Font</td>
<td>Font type</td>
<td><code class="docutils literal notranslate"><span class="pre">'font_name'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">"Arial"</span></code></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Font size</td>
<td><code class="docutils literal notranslate"><span class="pre">'font_size'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">12</span></code></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Font color</td>
<td><code class="docutils literal notranslate"><span class="pre">'font_color'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">#efefef</span></code></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Bold</td>
<td><code class="docutils literal notranslate"><span class="pre">'bold'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">True/False</span></code></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Italic</td>
<td><code class="docutils literal notranslate"><span class="pre">'italic'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">True/False</span></code></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Underline</td>
<td><code class="docutils literal notranslate"><span class="pre">'underline'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">True/False</span></code></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Strikeout</td>
<td><code class="docutils literal notranslate"><span class="pre">'font_strikeout'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">True/False</span></code></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Super/Subscript</td>
<td><code class="docutils literal notranslate"><span class="pre">'font_script'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">1 = Superscript, 2 = Subscript</span></code></td>
</tr>
<tr class="row-even"><td>Number</td>
<td>Numeric format</td>
<td><code class="docutils literal notranslate"><span class="pre">'num_format'</span></code></td>
<td><a class="reference internal" href="#set_num_format" title="set_num_format"><code class="xref py py-func docutils literal notranslate"><span class="pre"><a href="https://xlsxwriter.readthedocs.io/format.html#set_num_format">See xlsxwriter docs</a></span></code></a></td>
</tr>
<tr class="row-odd"><td>Protection</td>
<td>Lock cells</td>
<td><code class="docutils literal notranslate"><span class="pre">'locked'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">True/False</span></code></td>
</tr>
<tr class="row-odd"><td>Alignment</td>
<td>Horizontal align</td>
<td><code class="docutils literal notranslate"><span class="pre">'align'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">left, 
center,
right,<br/>
fill,
justify,
center_across,<br/>
distributed</span></code></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Vertical align</td>
<td><code class="docutils literal notranslate"><span class="pre">'valign'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">
top,
vcenter,
bottom,<br/>
vjustify,
vdistributed</span></code></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Rotation</td>
<td><code class="docutils literal notranslate"><span class="pre">'rotation'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">45</span></code> (degrees)</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Text wrap</td>
<td><code class="docutils literal notranslate"><span class="pre">'text_wrap'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">True/False</span></code></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Justify last</td>
<td><code class="docutils literal notranslate"><span class="pre">'text_justlast'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">True/False</span></code></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Center across</td>
<td><code class="docutils literal notranslate"><span class="pre">'center_across'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">True/False</span></code></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Indentation</td>
<td><code class="docutils literal notranslate"><span class="pre">'indent'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">1,2 </span></code>(indent level)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Shrink to fit</td>
<td><code class="docutils literal notranslate"><span class="pre">'shrink'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">True/False</span></code></td>
</tr>
<tr class="row-even"><td>Pattern</td>
<td>Cell pattern</td>
<td><code class="docutils literal notranslate"><span class="pre">'pattern'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">0-18</span></code></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Background color</td>
<td><code class="docutils literal notranslate"><span class="pre">'bg_color'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">#efefef</span></code></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Foreground color</td>
<td><code class="docutils literal notranslate"><span class="pre">'fg_color'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">#efefef</span></code></td>
</tr>
<tr class="row-odd"><td>Border</td>
<td>Cell border</td>
<td><code class="docutils literal notranslate"><span class="pre">'border'</span></code></td>
<td><a class="reference internal" href="https://xlsxwriter.readthedocs.io/format.html#set_border" title="set_border"><code class="xref py py-func docutils literal notranslate"><span class="pre">See xlsxwwriter docs</span></code></a></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Bottom border</td>
<td><code class="docutils literal notranslate"><span class="pre">'bottom'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">1,2,3</span></code> (see docs for set_border)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Top border</td>
<td><code class="docutils literal notranslate"><span class="pre">'top'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">1,2,3, ...</span></code> (see docs for set_border)</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Left border</td>
<td><code class="docutils literal notranslate"><span class="pre">'left'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">1,2,3, ...</span></code> (see docs for set_border)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Right border</td>
<td><code class="docutils literal notranslate"><span class="pre">'right'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">1,2,3, ...</span></code> (see docs for set_border)</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Border color</td>
<td><code class="docutils literal notranslate"><span class="pre">'border_color'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">#efefef</span></code></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Bottom color</td>
<td><code class="docutils literal notranslate"><span class="pre">'bottom_color'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">#efefef</span></code></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Top color</td>
<td><code class="docutils literal notranslate"><span class="pre">'top_color'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">#efefef</span></code></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>Left color</td>
<td><code class="docutils literal notranslate"><span class="pre">'left_color'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">#efefef</span></code></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>Right color</td>
<td><code class="docutils literal notranslate"><span class="pre">'right_color'</span></code></td>
<td><code class="xref py py-func docutils literal notranslate"><span class="pre">#efefef</span></code></td>
</tr>
</tbody>
</table>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="6_create_crosstabs.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Create crosstabs</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="the_api.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The API</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Datasmoothie<br/>
  
      &copy; Copyright 2023, Datasmoothie.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>