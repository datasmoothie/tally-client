
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Add bold column with totals</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/assets/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script src="_static/design-tabs.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Formatting bases in Excel" href="formatting_header_and_base.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/datasmoothie-logo.svg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Quick_Start.html">
   Quick start
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The pipeline
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="pipeline_intro.html">
   Building a survey data pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="1_load_data.html">
   Load/extract data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_explore_data.html">
   Explore data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_clean_data.html">
   Clean data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_create_variables.html">
   Create variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_weight_data.html">
   Weight data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_create_crosstabs.html">
   Create crosstabs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7_build_excel_output.html">
   Build Excel tables
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="the_api.html">
   The API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="api_build.html">
   Building outputs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="api_dataset.html">
   DataSet class
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="terminology.html">
   Terminology
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Examples
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="formatting_header_and_base.html">
   Formatting bases in Excel
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Add bold column with totals
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right"><a href="https://github.com/datasmoothie/tally-client"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-a-total-column-and-format-it">
   Add a total column and format it
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Add bold column with totals</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-a-total-column-and-format-it">
   Add a total column and format it
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="add-bold-column-with-totals">
<h1>Add bold column with totals<a class="headerlink" href="#add-bold-column-with-totals" title="Permalink to this headline">#</a></h1>
<p>By default, the Excel outputs are simple black text, without formatting. The most basic output can be generated like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">tally</span><span class="o">.</span><span class="n">DataSet</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="n">token</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">api_url</span><span class="p">,</span> <span class="n">ssl</span><span class="o">=</span><span class="n">use_ssl</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">use_spss</span><span class="p">(</span><span class="s1">&#39;my_file.sav&#39;</span><span class="p">)</span>

<span class="n">build</span> <span class="o">=</span> <span class="n">tally</span><span class="o">.</span><span class="n">Build</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Client A&#39;</span><span class="p">,</span> <span class="n">default_dataset</span><span class="o">=</span><span class="n">ds</span><span class="p">)</span>

<span class="n">sheet</span> <span class="o">=</span> <span class="n">build</span><span class="o">.</span><span class="n">add_sheet</span><span class="p">(</span><span class="n">banner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;locality&#39;</span><span class="p">])</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="s1">&#39;q14r01c01&#39;</span><span class="p">})</span> 
<span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="s1">&#39;q14r02c01&#39;</span><span class="p">,</span> <span class="s1">&#39;stats&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">]})</span>

<span class="n">build</span><span class="o">.</span><span class="n">save_excel</span><span class="p">(</span><span class="s1">&#39;test_table_without_formatting.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="Unformatted Excel table" src="_images/Excel-no-formatting-clean.png" /></p>
<section id="add-a-total-column-and-format-it">
<h2>Add a total column and format it<a class="headerlink" href="#add-a-total-column-and-format-it" title="Permalink to this headline">#</a></h2>
<p>To add a total column to a data table, we need to add an option to the stub that defines the table. This can be one on a table-by-table bases</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="s1">&#39;q14r01c01&#39;</span><span class="p">,</span> <span class="s1">&#39;xtotal&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">})</span> 
</pre></div>
</div>
<p>But below we want to apply it to the entire sheet, so we add it to the sheet options. In both the sheet and build options, we can add
extra options to the stub, to save us from adding it to every single table definition.</p>
<p>Then, we use <code class="docutils literal notranslate"><span class="pre">set_column_format_for_type</span></code> and add a format for both the <code class="docutils literal notranslate"><span class="pre">base</span></code> type and <code class="docutils literal notranslate"><span class="pre">percentage</span></code> type so that the formatting will apply to our whole column.</p>
<p>The result is an excel table with a total column in bold.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">tally</span><span class="o">.</span><span class="n">DataSet</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="n">token</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">api_url</span><span class="p">,</span> <span class="n">ssl</span><span class="o">=</span><span class="n">use_ssl</span><span class="p">)</span>
<span class="n">ds</span><span class="o">.</span><span class="n">use_spss</span><span class="p">(</span><span class="s1">&#39;mydata.sav&#39;</span><span class="p">)</span>

<span class="n">build</span> <span class="o">=</span> <span class="n">tally</span><span class="o">.</span><span class="n">Build</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Client A&#39;</span><span class="p">,</span> <span class="n">subtitle</span><span class="o">=</span><span class="s2">&quot;Datasmoothie&quot;</span><span class="p">,</span> <span class="n">default_dataset</span><span class="o">=</span><span class="n">ds</span><span class="p">)</span>

<span class="n">sheet</span> <span class="o">=</span> <span class="n">build</span><span class="o">.</span><span class="n">add_sheet</span><span class="p">(</span><span class="n">banner</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="s1">&#39;locality&#39;</span><span class="p">])</span>
<span class="hll"><span class="n">sheet</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_stub</span><span class="p">({</span><span class="s1">&#39;xtotal&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</span><span class="hll"><span class="n">sheet</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_column_format_for_type</span><span class="p">(</span><span class="s1">&#39;base&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;bold&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">})</span>
</span><span class="hll"><span class="n">sheet</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">set_column_format_for_type</span><span class="p">(</span><span class="s1">&#39;percentage&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;bold&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">})</span>
</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="s1">&#39;q14r01c01&#39;</span><span class="p">})</span> 
<span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="s1">&#39;q14r02c01&#39;</span><span class="p">,</span> <span class="s1">&#39;stats&#39;</span><span class="p">:[</span><span class="s1">&#39;mean&#39;</span><span class="p">]})</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">stub</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="s1">&#39;q14r03c01&#39;</span><span class="p">})</span>

<span class="n">build</span><span class="o">.</span><span class="n">save_excel</span><span class="p">(</span><span class="s1">&#39;test_table_with_totals.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="Formatted Excel table" src="_images/Excel-table-with-totals.png" /></p>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="formatting_header_and_base.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Formatting bases in Excel</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Datasmoothie<br/>
  
      &copy; Copyright 2023, Datasmoothie.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>